<ng-container
    *ngIf="{
        weatherObject: weatherObject$ | async,
        locationList: locationList$ | async
    } as data"
>
    <div
        class="background-wrapper"
        *ngIf="data.weatherObject; else loadingBackground"
    >
        <div
            class="background"
            [ngStyle]="{
                'background-image': getBackgroundUrl(data.weatherObject.code)
            }"
        ></div>
    </div>

    <section>
        <app-search-form
            [locationList]="data.locationList"
            [hasFocus]="searchHasFocus"
            (focusRequest$)="onFocus($event)"
            (locationRequest$)="locationRequest($event)"
            (weatherRequest$)="weatherRequest($event)"
        ></app-search-form>

        <app-current-item
            *ngIf="data.weatherObject; else loadingCurrent"
            [data]="data.weatherObject"
            [units]="units"
        ></app-current-item>

        <article *ngIf="data.weatherObject; else loadingForecast" class="">
            <app-forecast-item
                *ngFor="let forecastDay of data.weatherObject.forecast"
                [data]="forecastDay"
                [units]="units"
            ></app-forecast-item>
        </article>

        <footer>
            <small>Powered by </small>
            <a
                href="https://www.weatherapi.com/"
                target="_blank"
                title="Weather API"
                ><h5>WeatherAPI.com</h5>
            </a>
        </footer>
    </section>
</ng-container>

<!-- Loading -->

<ng-template #loadingBackground>
    <div class="background-wrapper">
        <div
            class="background"
            [ngStyle]="{
                'background-image': getBackgroundUrl(1000)
            }"
        ></div>
    </div>
</ng-template>

<ng-template #loadingCurrent>
    <div class="center">
        <!-- Main -->
        <h4>Templateville</h4>
        <h1>4</h1>
        <h4>Klart</h4>
        <!-- Data points -->
        <div>
            <div>
                <h5>MIN/MAX</h5>
                <h4>0 / 22</h4>
            </div>
            <div>
                <h5>Vindhastighet</h5>
                <h4>6 m/s</h4>
            </div>

            <div>
                <h5>Vindriktning</h5>
                <h4>NSW</h4>
            </div>

            <div>
                <h5>Luftfuktighet</h5>
                <h4>50 %</h4>
            </div>
        </div>
    </div>
</ng-template>

<ng-template #loadingForecast>
    <div>
        <div>
            <div *ngFor="let day of forecastDayRange">
                <span> 1970 - 01 - 01 </span>
                <span>icon</span>
                <span>0 / 22</span>
            </div>
        </div>
    </div>
</ng-template>
